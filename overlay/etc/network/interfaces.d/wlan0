auto wlan0
iface wlan0 inet dhcp
	pre-up /etc/wireless/sdio $(fw_printenv -n wlandev) || /etc/wireless/usb $(fw_printenv -n wlandev)
	pre-up wlan_addr=$(fw_printenv -n wlanaddr); if [ -n "$wlan_addr" ]; then ip link set dev wlan0 address $wlan_addr; fi
	pre-up wpa_passphrase "$(fw_printenv -n wlanssid)" "$(fw_printenv -n wlanpass)" > /tmp/wpa_supplicant.conf
	pre-up sed -i 's/#psk.*/scan_ssid=1/g' /tmp/wpa_supplicant.conf
	pre-up wpa_supplicant -B -i wlan0 -D nl80211,wext -c /tmp/wpa_supplicant.conf
	post-down killall -q wpa_supplicant
